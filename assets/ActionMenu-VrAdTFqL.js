import{c as y,o as C,s as N,j as t,H as P,r as l,t as w,i as D,p as M,q as j,v as $,w as z,x as F,y as B,u as I,a as H,z as L,I as R,T as U,B as T,m as q,U as O,E as V,A as K,b as Z,D as G,f as J,g as Q,h as _}from"./index-DJHNwpjx.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],X=y("circle-check-big",W);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]],ee=y("dot",Y);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],se=y("ellipsis",te);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ae=y("pencil",re);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],oe=y("trash-2",ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"m19 5 3-3",key:"yk6iyv"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m12 6 6 6 2.3-2.3a2.4 2.4 0 0 0 0-3.4l-2.6-2.6a2.4 2.4 0 0 0-3.4 0Z",key:"1snsnr"}]],ie=y("unplug",ce),le=C({title:N().trim().nonempty("title_required").min(3,"min_3_characters").max(200,"max_200_characters"),content:N().trim().nonempty("content_required").min(3,"min_3_characters").max(500,"max_500_characters")}),S=({id:n,label:e,error:s,children:r})=>t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-bold ml-3 mb-2 inline-block",htmlFor:n,children:e}),r,s&&t.jsx(P,{type:"error",message:s})]}),de={sm:"px-3 py-2 text-sm ",md:"px-4 py-4 text-base ",lg:"px-6 py-6 text-2xl"},ue={outline:"bg-transparent border border-subtle dark:focus-within:bg-gray-400/5",filled:"bg-input border border-transparent focus-within:bg-gray-400/10"},me=l.forwardRef(function({className:n,size:e="md",id:s,invalid:r,value:a,variant:c="outline",displayCharCount:i=!0,innerClassName:h,onChange:o,autoFocus:x,icon:f,maxLength:m,...p},v){const[k,g]=l.useState(0),d=l.useRef(null);l.useImperativeHandle(v,()=>d.current);const b=l.useCallback(()=>{const u=d.current;u&&(u.style.height="auto",u.style.height=`${u.scrollHeight}px`)},[d]),A=l.useCallback(u=>{b(),g(u.target.value.length)},[b,g]);return l.useEffect(()=>b(),[b]),l.useEffect(()=>{a!=null&&g(a.toString().length)},[a]),l.useEffect(()=>{if(x){const u=d.current;if(!u)return;u.focus(),u.setSelectionRange(u.value.length,u.value.length)}},[x]),t.jsxs("div",{className:w("flex flex-col items-start gap-2 rounded-3xl px-3 py-2 transition-colors text-foreground-100 relative",ue[c],de[e],M("border-transparent bg-red-700/5 focus-within:bg-red-400/5",r),n),children:[t.jsxs("div",{className:"flex gap-2 self-stretch flex-1  overflow-y-auto",children:[f&&t.jsx("div",{className:"text-gray-500",children:f}),t.jsx("textarea",{id:s,ref:d,value:a,onChange:o,className:D("flex-1 outline-none bg-transparent placeholder-gray-400 text-md resize-none w-full h-full",h),rows:1,onInput:A,maxLength:m,...p})]}),!!m&&t.jsx("span",{className:"text-xs  text-foreground-200 absolute right-4 bottom-2",children:`${k}/${m}`})]})});class he{static BASE_URL="https://665de6d7e88051d60408c32d.mockapi.io";static PATH;static sleep(e){return new Promise(s=>setTimeout(s,e))}static async doFetch(e,s,r,a,c){c?.delay&&await this.sleep(c.delay);const i=new Headers;i.set("Content-Type","application/json");let h=`${this.BASE_URL}${this.PATH||""}${s||""}`;r&&(h=h+"?"+r);try{let o={method:e,headers:i};if(a){const m=a?JSON.stringify(a):void 0;o.body=m}const x=await fetch(h,o);if(!x.ok){const m=await x.text();let p="api_error";return m=='"Not found"'&&(p="not_found"),{hasError:!0,ok:!1,error:p}}return{data:await x.json(),hasError:!1,ok:!0}}catch(o){return console.log(o),{hasError:!0,error:"unknown_error",ok:!1}}}static get(e,s,r){return this.doFetch("GET",e,s,null,r)}static post(e,s,r){return this.doFetch("POST",e,void 0,s,r)}static put(e,s,r){return this.doFetch("PUT",e,void 0,s,r)}static del(e,s){return this.doFetch("DELETE",e,void 0,null,s)}}class E extends he{static PATH="/post";static buildFilterParams(e){if(!e)return"";const s=new URLSearchParams,r={page:"page",pageSize:"limit",searchTerm:"search",sortBy:"sortBy",order:"order"};return Object.entries(e).forEach(([a,c])=>{if(c!=null&&c!==""){const i=r[a];i&&s.append(i,String(c))}}),s.toString()}static list(e,s){return this.get("",this.buildFilterParams(e),{delay:s})}static detail(e){return this.get(`/${e}`)}static create(e,s){const r={...e,...s,createdAt:new Date().toISOString()};return this.post("",r)}static update(e,s,r){const a={...s,...r,updatedAt:new Date().toISOString()};return this.put(`/${e}`,a)}static delete(e){return this.del(`/${e}`)}}const xe=({date:n,format:e,...s})=>{const[r,a]=l.useMemo(()=>{const c=new Date(n);if(!c)return["",""];let i="";if(e==="time-ago"){const o=(Date.now()-c.getTime())/1e3;o<0?i=j.t("common.fromFuture"):o<120?i=j.t("common.momentAgo"):i=$(j.language,c)}return[z(j.language,c),i]},[j.language,n,e]);return e==="date"?t.jsx("div",{...s,children:r}):t.jsx("div",{title:r,...s,children:a})},fe=({onSuccess:n,post:e,user:s})=>{const{register:r,handleSubmit:a,formState:{errors:c,isSubmitting:i,isValid:h}}=F({resolver:B(le),mode:"all",defaultValues:{title:e?.title??"",content:e?.content??""}}),{translate:o}=I(),{markPostAsOwned:x}=H(),[f,m]=l.useState(),[p,v]=l.useState(!1),k=l.useCallback(async g=>{m(null);let d;if(e?d=await E.update(e.id,g,s):d=await E.create(g,s),d.hasError){m(d.error);return}x(d.data.id),v(!0),setTimeout(()=>{n(d.data)},1e3)},[s,e]);return t.jsxs("form",{onSubmit:a(k),className:"flex flex-col items-stretch gap-2",children:[p&&t.jsx(pe,{message:o(e?"posts.create.saved":"posts.create.published")}),t.jsx("h2",{className:"text-lg font-semibold text-foreground-100",children:o(e?"posts.updatePost":"posts.createPost")}),f&&t.jsx(L,{title:o(f,{defaultKey:"common.error",defaultValue:""}),status:"info"}),t.jsx(S,{id:"title",label:o("posts.create.title"),error:o(c.title?.message,{prefix:"validationErrors"}),children:t.jsx(R,{id:"title",variant:"filled",autoFocus:!0,placeholder:o("posts.create.titlePlaceholder"),...r("title")})}),t.jsx(S,{id:"content",label:o("posts.create.content"),error:o(c.content?.message,{prefix:"validationErrors"}),children:t.jsx(me,{id:"content",variant:"filled",placeholder:o("posts.create.contentPlaceholder"),className:"h-[15em]",maxLength:500,...r("content",{maxLength:500})})}),!!e&&t.jsxs("div",{className:"flex rounded-full text-sm font-bold",children:[t.jsx(ee,{})," Created at:",t.jsx(xe,{date:e.createdAt,format:"date",className:"ml-2 font-medium"})]}),t.jsx("div",{className:"ml-auto mt-4",children:t.jsx(U,{content:o("validationErrors.complete_required_fields"),position:"left",disabled:h||i,children:t.jsx(T,{disabled:!h||i,type:"submit",loading:i,children:o(e?"common.save":"posts.create.publish")})})})]})},pe=({message:n})=>t.jsx("div",{className:"absolute h-full w-full text-primary-600 bg-black/20 top-0 left-0 flex items-center justify-center flex-col text-2xl font-bold post-success-overlay z-10",children:t.jsxs("div",{className:"flex flex-col items-center post-success-overlay-content",children:[t.jsx(X,{className:"h-20 w-20 "}),n]})}),je=({isOpen:n,onClose:e,onSuccess:s,post:r})=>{const{user:a}=q(),c=i=>{if(i=="closed"){e();return}};return a?t.jsx(V,{isOpen:n,onClose:e,title:t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(K,{name:a.name,src:a.avatar,size:"sm"})," ",a.name]}),children:t.jsx(fe,{onSuccess:s,user:a,post:r})}):t.jsx(O,{isOpen:n,onClose:c})},be=({className:n,repeat:e=1,wrapperClassName:s,...r})=>{const a=w("animate-pulse rounded-2xl bg-content-100/50 dark:bg-content-200 w-full shadow-md",n);return e<=1?t.jsx("div",{className:a,...r}):t.jsx("div",{className:w("flex flex-col gap-4 self-stretch",s),children:Array.from({length:e}).map((c,i)=>t.jsx("div",{className:a,...r},i))})},ve=({message:n})=>{const{t:e}=Z();return t.jsxs("div",{className:"flex justify-center items-center gap-4 rounded-lg bg-content-100 text-foreground-200 p-14 text-xl shadow-md",children:[t.jsx(ie,{className:"w-10 h-10 shrink-0 text-foreground-200"}),t.jsx("span",{children:n??e("common.error")})]})},ge={sm:"p-4 h-4 w-4",md:"p-6 h-6 w-6"},ke=({onEdit:n,onDelete:e,size:s="md"})=>{const r=l.useCallback(a=>{if(a=="edit"){n();return}a=="delete"&&e()},[n,e]);return t.jsxs(G,{onSelect:r,children:[t.jsx(J,{children:t.jsx(T,{variant:"ghost",className:ge[s],rightIcon:t.jsx(se,{className:"w-[1em] h-[1em] text-foreground-200"})})}),t.jsxs(Q,{children:[t.jsxs(_,{value:"edit",children:[t.jsx(ae,{className:"h-4 w-4"})," Edit"]}),t.jsxs(_,{value:"delete",children:[t.jsx(oe,{className:"h-4 w-4"})," Delete"]})]})]})};export{ke as A,xe as D,ve as E,E as P,be as S,me as T,je as a,he as b};
